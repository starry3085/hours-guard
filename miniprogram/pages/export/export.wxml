<view class="page-container">
  <!-- 页面标题 -->
  <view class="header">
    <text class="title">记录导出</text>
    <text class="subtitle">支持Excel表格、图片报告、文本记录</text>
  </view>
  
  <!-- 月份选择卡片 -->
  <view class="month-card">
    <view class="card-header">
      <text class="card-title">选择导出月份</text>
    </view>
    
    <picker mode="date" fields="month" value="{{selectedDate}}" bindchange="onDateChange" class="month-picker">
      <view class="picker-display">
        <text class="selected-month">{{selectedMonth}}</text>
        <text class="picker-arrow">▼</text>
      </view>
    </picker>
  </view>

  <!-- 数据统计卡片 -->
  <view class="stats-card" wx:if="{{recordCount > 0}}">
    <view class="card-header">
      <text class="card-title">数据概览</text>
    </view>
    
    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-number">{{recordCount}}</text>
        <text class="stat-label">打卡天数</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{totalWorkHours}}</text>
        <text class="stat-label">总工作时长(h)</text>
      </view>
    </view>
  </view>

  <!-- 空数据提示 -->
  <view class="empty-card" wx:if="{{recordCount === 0}}">
    <text class="empty-text">该月份暂无打卡数据</text>
    <text class="empty-hint">请选择其他月份或先去打卡页面记录</text>
  </view>

  <!-- 操作按钮 -->
  <view class="action-section">
    <button class="export-btn {{isGenerating ? 'generating' : ''}}" 
            bindtap="makeReport" 
            disabled="{{isGenerating || recordCount === 0}}"
            hover-class="btn-hover">
      <text class="btn-text">{{isGenerating ? '生成中...' : '导出记录'}}</text>
    </button>
    
    <button class="share-btn {{!pdfPath ? 'disabled' : ''}}" 
            bindtap="sharePdf" 
            disabled="{{!pdfPath}}"
            hover-class="btn-hover">
      <text class="btn-text">分享文件</text>
    </button>
    
    <button class="storage-btn" 
            bindtap="onGoToStorage"
            hover-class="btn-hover">
      <text class="btn-text">存储管理</text>
    </button>
  </view>

  <!-- 功能说明 -->
  <view class="info-section">
    <view class="info-card">
      <view class="info-header">
        <text class="info-title">导出内容包含</text>
      </view>
      <view class="info-list">
        <view class="info-item">
          <text class="info-text">完整的打卡记录表格</text>
        </view>
        <view class="info-item">
          <text class="info-text">工作时长统计分析</text>
        </view>
        <view class="info-item">
          <text class="info-text">专业的报告格式</text>
        </view>
      </view>
    </view>
    
    <view class="warning-card">
      <text class="warning-text">数据仅保存在本机，请定期导出备份！</text>
    </view>
  </view>

  <!-- 隐藏的Canvas用于图片生成 -->
  <canvas type="2d" id="canvas" class="hidden-canvas"></canvas>
</view> 