<view class="page-container">
  <!-- 页面标题 -->
  <view class="header">
    <text class="title">记录导出</text>
  </view>
  
  <!-- 月份选择卡片 -->
  <view class="month-card">
    <view class="card-header">
      <text class="card-title">选择导出月份范围</text>
    </view>
    
    <view class="date-range-container">
      <!-- 起始月份选择器 -->
      <view class="date-picker-label">起始月份</view>
      <view class="month-picker" bindtap="openStartDatePicker">
        <view class="picker-display">
          <view class="picker-icon">
            <view class="calendar-icon"></view>
          </view>
          <text class="selected-month">{{selectedStartMonth}}</text>
          <view class="picker-arrow">›</view>
        </view>
      </view>
      
      <!-- 结束月份选择器 -->
      <view class="date-picker-label">结束月份</view>
      <view class="month-picker" bindtap="openEndDatePicker">
        <view class="picker-display">
          <view class="picker-icon">
            <view class="calendar-icon"></view>
          </view>
          <text class="selected-month">{{selectedEndMonth}}</text>
          <view class="picker-arrow">›</view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- 起始日期选择器弹窗 -->
  <view class="date-picker-overlay {{showStartDatePicker ? 'show' : ''}}" wx:if="{{showStartDatePicker}}">
    <view class="date-picker-modal">
      <view class="date-picker-header">
        <text class="date-picker-title">选择起始年月</text>
        <view class="date-picker-close" bindtap="closeDatePicker">×</view>
      </view>
      
      <view class="date-picker-body">
        <!-- 年份选择区域 -->
        <view class="year-month-grid">
          <block wx:for="{{yearList}}" wx:key="*this">
            <view class="year-item {{tempStartYear === item ? 'active' : ''}}" 
                  bindtap="selectStartYear" 
                  data-year="{{item}}">
              {{item}}
            </view>
          </block>
        </view>
        
        <!-- 月份选择区域 -->
        <view class="year-month-grid" style="margin-top: 30rpx;">
          <block wx:for="{{monthList}}" wx:key="*this">
            <view class="month-item {{tempStartMonth === item ? 'active' : ''}}" 
                  bindtap="selectStartMonth" 
                  data-month="{{item}}">
              {{item}}月
            </view>
          </block>
        </view>
      </view>
      
      <view class="date-picker-footer">
        <view class="picker-btn picker-btn-cancel" bindtap="closeDatePicker">取消</view>
        <view class="picker-btn picker-btn-confirm" bindtap="confirmStartDateSelection">确定</view>
      </view>
    </view>
  </view>
  
  <!-- 结束日期选择器弹窗 -->
  <view class="date-picker-overlay {{showEndDatePicker ? 'show' : ''}}" wx:if="{{showEndDatePicker}}">
    <view class="date-picker-modal">
      <view class="date-picker-header">
        <text class="date-picker-title">选择结束年月</text>
        <view class="date-picker-close" bindtap="closeDatePicker">×</view>
      </view>
      
      <view class="date-picker-body">
        <!-- 年份选择区域 -->
        <view class="year-month-grid">
          <block wx:for="{{yearList}}" wx:key="*this">
            <view class="year-item {{tempEndYear === item ? 'active' : ''}}" 
                  bindtap="selectEndYear" 
                  data-year="{{item}}">
              {{item}}
            </view>
          </block>
        </view>
        
        <!-- 月份选择区域 -->
        <view class="year-month-grid" style="margin-top: 30rpx;">
          <block wx:for="{{monthList}}" wx:key="*this">
            <view class="month-item {{tempEndMonth === item ? 'active' : ''}}" 
                  bindtap="selectEndMonth" 
                  data-month="{{item}}">
              {{item}}月
            </view>
          </block>
        </view>
      </view>
      
      <view class="date-picker-footer">
        <view class="picker-btn picker-btn-cancel" bindtap="closeDatePicker">取消</view>
        <view class="picker-btn picker-btn-confirm" bindtap="confirmEndDateSelection">确定</view>
      </view>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view class="action-section">
    <view class="custom-btn {{isGenerating ? 'custom-btn-disabled' : (recordCount === 0 ? 'custom-btn-disabled' : 'custom-btn-out')}}" 
          bindtap="makeReport">
      <text>{{isGenerating ? '生成中...' : '导出记录'}}</text>
    </view>
  </view>

  <!-- 文本预览弹窗 -->
  <view class="preview-modal {{showPreview ? 'show' : ''}}" wx:if="{{showPreview}}">
    <view class="preview-content">
      <view class="preview-header">
        <text class="preview-title">打卡记录预览</text>
        <view class="preview-close" bindtap="closePreview">×</view>
      </view>
      
      <scroll-view scroll-y class="preview-text-container">
        <text class="preview-text">{{exportedText}}</text>
      </scroll-view>
      <view class="preview-footer">
        <view class="copy-btn" bindtap="copyTextToClipboard">一键复制全文</view>
      </view>
    </view>
  </view>

  <!-- 提示信息 -->
  <view class="tips-section data-backup-notice">
    <view class="tip-item">
      <view class="tip-icon"></view>
      <text class="tip-text bold-tip">所有数据仅保存在本机，请定期导出备份</text>
    </view>
  </view>
</view>