<view class="page-container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header">
    <text class="title">å·¥æ—¶ç»Ÿè®¡</text>
  </view>

  <!-- æœˆä»½æ˜¾ç¤ºå’Œé€‰æ‹© -->
  <view class="month-display" bindtap="openDatePicker">
    <view class="picker-icon">
      <view class="calendar-icon"></view>
    </view>
    <text class="month-text">{{currentMonth}}</text>
  </view>
  
  <!-- è‡ªå®šä¹‰æ—¥æœŸé€‰æ‹©å™¨å¼¹çª— -->
  <view class="date-picker-overlay {{showDatePicker ? 'show' : ''}}" wx:if="{{showDatePicker}}">
    <view class="date-picker-modal">
      <view class="date-picker-header">
        <text class="date-picker-title">é€‰æ‹©å¹´æœˆ</text>
        <view class="date-picker-close" bindtap="closeDatePicker">Ã—</view>
      </view>
      
      <view class="date-picker-body">
        <!-- å¹´ä»½é€‰æ‹©åŒºåŸŸ -->
        <view class="year-month-grid">
          <block wx:for="{{yearList}}" wx:key="*this">
            <view class="year-item {{tempYear === item ? 'active' : ''}}" 
                  bindtap="selectYear" 
                  data-year="{{item}}">
              {{item}}
            </view>
          </block>
        </view>
        
        <!-- æœˆä»½é€‰æ‹©åŒºåŸŸ -->
        <view class="year-month-grid" style="margin-top: 30rpx;">
          <block wx:for="{{monthList}}" wx:key="*this">
            <view class="month-item {{tempMonth === item ? 'active' : ''}}" 
                  bindtap="selectMonth" 
                  data-month="{{item}}">
              {{item}}æœˆ
            </view>
          </block>
        </view>
      </view>
      
      <view class="date-picker-footer">
        <view class="picker-btn picker-btn-cancel" bindtap="closeDatePicker">å–æ¶ˆ</view>
        <view class="picker-btn picker-btn-confirm" bindtap="confirmDateSelection">ç¡®å®š</view>
      </view>
    </view>
  </view>

  <!-- ç»Ÿè®¡åŒºåŸŸ -->
  <view class="stats-section" wx:if="{{list.length > 0}}">
    <view class="stats-card">
      <!-- åªæœ‰å½“é€‰æ‹©çš„æ˜¯å½“å‰æœˆä»½æ—¶æ‰æ˜¾ç¤ºæœ¬å‘¨ç»Ÿè®¡ -->
      <view class="stats-row" wx:if="{{isCurrentMonth}}">
        <view class="stat-item">
          <text class="stat-label">æœ¬å‘¨æ€»å·¥æ—¶</text>
          <text class="stat-value">{{weeklyStats.totalHours}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">æœ¬å‘¨å¹³å‡å·¥æ—¶</text>
          <text class="stat-value">{{weeklyStats.avgHours}}</text>
        </view>
      </view>
      <view class="stats-row">
        <view class="stat-item">
          <text class="stat-label">æœ¬æœˆå¹³å‡å·¥æ—¶</text>
          <text class="stat-value">{{monthlyStats.avgHours}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">æœ¬æœˆæ‰“å¡å¤©æ•°</text>
          <text class="stat-value">{{monthlyStats.workDays}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- è®°å½•åˆ—è¡¨ -->
  <view class="records-section" wx:if="{{list.length > 0}}">
    <view class="record-card">
      <scroll-view scroll-y class="record-list" enable-back-to-top>
        <view wx:for="{{list}}" wx:key="date" class="record-row">
          <view class="cell-date">
            <text class="date-text">{{item.displayDate}}</text>
          </view>
          
          <view class="cell-time-range">
            <text class="time-range-text {{(item.on && item.off) ? 'has-time' : 'no-time'}}">
              {{(item.on && item.off) ? (item.on + ' - ' + item.off) : 'æœªæ‰“å¡'}}
            </text>
          </view>
          
          <view class="cell-workhours">
            <text class="time-text work-hours {{item.workHours ? 'has-time' : 'no-time'}}">{{item.workHours ? item.workHours : '-'}}</text>
          </view>
          
          <view class="cell-actions">
            <view class="action-btn edit-btn" bindtap="onEditRecord" data-date="{{item.date}}">
              <text class="action-icon">âœï¸</text>
            </view>
            <view class="action-btn delete-btn" bindtap="onDeleteRecord" data-date="{{item.date}}">
              <text class="action-icon">ğŸ—‘ï¸</text>
            </view>
          </view>
        </view>
      </scroll-view>
    </view>
  </view>



  <!-- æ—¶é—´é€‰æ‹©å™¨å¼¹çª— -->
  <view wx:if="{{showPicker}}" class="picker-overlay">
    <view class="picker-modal">
      <view class="picker-header">
        <text class="picker-cancel" bindtap="onPickerCancel">å–æ¶ˆ</text>
        <text class="picker-title">ä¿®æ”¹{{pickerType === 'on' ? 'ä¸Šç­' : 'ä¸‹ç­'}}æ—¶é—´</text>
        <text class="picker-confirm" bindtap="onPickerConfirm">ç¡®å®š</text>
      </view>
      
      <view class="picker-body">
        <picker-view 
          class="picker-view"
          value="{{pickerValue}}" 
          bindchange="onPickerChange">
          <picker-view-column>
            <view wx:for="{{hours}}" wx:key="*this" class="picker-item">{{item}}</view>
          </picker-view-column>
          <picker-view-column>
            <view wx:for="{{minutes}}" wx:key="*this" class="picker-item">{{item}}</view>
          </picker-view-column>
        </picker-view>
        
        <view class="picker-indicator">
          <text class="time-display">{{hours[pickerValue[0]]}}:{{minutes[pickerValue[1]]}}</text>
        </view>
      </view>
    </view>
  </view>
</view>