<view class="page-container">
  <!-- 页面标题 -->
  <view class="header">
    <text class="title">工时统计</text>
  </view>

  <!-- 月份显示 -->
  <view class="month-display">
    <text class="month-text">{{currentMonth}}</text>
  </view>

  <!-- 统计区域 -->
  <view class="stats-section" wx:if="{{list.length > 0}}">
    <view class="stats-card">
      <view class="stats-row">
        <view class="stat-item">
          <text class="stat-label">本周总工时</text>
          <text class="stat-value">{{weeklyStats.totalHours}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">本周平均工时</text>
          <text class="stat-value">{{weeklyStats.avgHours}}</text>
        </view>
      </view>
      <view class="stats-row">
        <view class="stat-item">
          <text class="stat-label">本月平均工时</text>
          <text class="stat-value">{{monthlyStats.avgHours}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">本月打卡天数</text>
          <text class="stat-value">{{monthlyStats.workDays}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 记录列表 -->
  <view class="records-section" wx:if="{{list.length > 0}}">
    <view class="record-card">
      <view class="list-header">
        <text class="header-date">日期</text>
        <text class="header-time">上班</text>
        <text class="header-time">下班</text>
      </view>
      
      <scroll-view scroll-y class="record-list" enable-back-to-top>
        <view wx:for="{{list}}" wx:key="date" class="record-row">
          <view class="cell-date">
            <text class="date-text">{{item.date}}</text>
            <text class="weekday">{{item.weekday ? item.weekday : ''}}</text>
          </view>
          
          <view class="cell-time" bindtap="onEditTime" data-type="on" data-date="{{item.date}}">
            <view class="time-container">
              <view class="record-icon record-icon-in" wx:if="{{item.on}}"></view>
              <text class="time-text {{item.on ? 'has-time' : 'no-time'}}">{{item.on ? item.on : '未打卡'}}</text>
            </view>
          </view>
          
          <view class="cell-time" bindtap="onEditTime" data-type="off" data-date="{{item.date}}">
            <view class="time-container">
              <view class="record-icon record-icon-out" wx:if="{{item.off}}"></view>
              <text class="time-text {{item.off ? 'has-time' : 'no-time'}}">{{item.off ? item.off : '未打卡'}}</text>
            </view>
          </view>
        </view>
      </scroll-view>
    </view>
  </view>



  <!-- 时间选择器弹窗 -->
  <view wx:if="{{showPicker}}" class="picker-overlay">
    <view class="picker-modal">
      <view class="picker-header">
        <text class="picker-cancel" bindtap="onPickerCancel">取消</text>
        <text class="picker-title">修改{{pickerType === 'on' ? '上班' : '下班'}}时间</text>
        <text class="picker-confirm" bindtap="onPickerConfirm">确定</text>
      </view>
      
      <view class="picker-body">
        <picker-view 
          class="picker-view"
          value="{{pickerValue}}" 
          bindchange="onPickerChange">
          <picker-view-column>
            <view wx:for="{{hours}}" wx:key="*this" class="picker-item">{{item}}</view>
          </picker-view-column>
          <picker-view-column>
            <view wx:for="{{minutes}}" wx:key="*this" class="picker-item">{{item}}</view>
          </picker-view-column>
        </picker-view>
        
        <view class="picker-indicator">
          <text class="time-display">{{hours[pickerValue[0]]}}:{{minutes[pickerValue[1]]}}</text>
        </view>
      </view>
    </view>
  </view>
</view>